# 快速开始指南 - Gemini CLI 版

> **版本**: v2.1 (防护增强版)  
> **适用工具**: Gemini CLI  
> **任务清单版本**: v4.1 (防护增强版)  
> **核心更新**: 集成防护机制，解决重复造轮子、AI幻觉、代码不完整问题

---

## 🚀 5分钟快速开始

### Step 1: 了解项目结构

```
gemini_fit_cycle/
├── docs/
│   ├── init_docs/              # 初始化文档（技术栈、规范等）
│   ├── pj_docs/                # 项目文档
│   │   ├── 00_环境上下文简报.md
│   │   ├── 01_需求模块化方案.md
│   │   ├── 02_需求原子化拆分.md
│   │   ├── 03_系统架构设计方案.md
│   │   ├── 04_接口与数据规约.md
│   │   ├── 04.5_原子任务交付看板.md
│   │   └── tasks/              # 任务工作目录
│   │       ├── U-1/            # 用户域任务1
│   │       │   ├── T5_分析文档.md
│   │       │   ├── T6_变更清单.md
│   │       │   ├── T7_测试报告.md
│   │       │   ├── T8_审计报告.md
│   │       │   └── T8.5_审查意见.md
│   │       └── U-2/            # 用户域任务2
│   └── templates/              # 文档模板
│       ├── T5_分析文档_模板.md
│       ├── T6_变更清单_模板.md
│       ├── T7_测试报告_模板.md
│       ├── T8_审计报告_模板.md
│       └── T8.5_审查意见_模板.md
├── .gemini-prompts.md          # ⭐ Gemini CLI 提示词模板库
├── 任务清单_v4.0_优化版.md      # 主任务清单
└── 快速开始指南.md              # 本文档
```

### Step 2: 查看当前进度

```bash
gemini "分析当前任务清单的执行情况，告诉我下一步应该做什么"
```

### Step 3: 选择下一个任务

根据 Gemini 的建议，选择一个待开始的任务，优先选择：
1. **P0 任务**（MVP 必需）
2. **无依赖或依赖已完成的任务**
3. **数据库设计任务**（通常是其他任务的依赖）

### Step 4: 生成代码库索引（首次使用，非常重要）

```bash
gemini "生成项目代码库索引，保存到 docs/pj_docs/代码库索引.md"
```

### Step 5: 执行任务（使用防护增强版）

```bash
# 方式1: 使用防护增强版提示词（推荐）
# 打开提示词文件
cat 防护增强版_T6编码提示词.md
# 复制对应的提示词，替换占位符后执行

# 方式2: 一键执行（适用于简单任务）
gemini "一键执行任务 U-3 的完整开发流程"

# 方式3: 分阶段执行
gemini "执行任务 U-3 的 T5 分析阶段"
gemini "执行任务 U-3 的 T6 编码阶段（使用防护增强版）"
# ... 依次执行 T7-T9
```

---

## 📋 任务执行流程详解

### P0/P1 任务（完整流程）

```
T5 分析 (2-4h)
├─ 读取相关文档
├─ 分析模块关联
├─ 评估影响范围
├─ 设计技术方案
└─ 生成 T5_分析文档.md
    ↓
T6 编码 (2-8h)
├─ 实现功能代码
├─ 添加注释
├─ 本地测试
└─ 生成 T6_变更清单.md
    ↓
T7 测试 (1-2h)
├─ 功能测试
├─ 边界测试
├─ 性能测试
└─ 生成 T7_测试报告.md
    ↓
T8 审计 (30min)
├─ 规范审计
├─ 质量审计
├─ 安全审计
└─ 生成 T8_审计报告.md
    ↓
T8.5 审查 (30min)
├─ 逻辑审查
├─ 架构审查
├─ 判断通过/驳回
└─ 生成 T8.5_审查意见.md
    ↓
T9 交付 (30min)
├─ Git 提交
├─ 更新看板
└─ 归档文档
```

### P2 任务（简化流程）

```
T5 快速分析 (30min)
├─ 简要技术方案
└─ 生成简化版 T5 文档
    ↓
T6 编码 (1-4h)
├─ 实现功能
└─ 简要记录变更
    ↓
T9 快速交付 (15min)
├─ Git 提交
└─ 更新看板
```

---

## 🤖 Gemini CLI 使用指南

### 核心概念

使用 Gemini CLI 时，所有操作都通过 **自然语言指令** 完成。我们为您准备了标准化的提示词模板库：`.gemini-prompts.md`

### 基本用法

```bash
# 基本格式
gemini "[您的指令]"

# 示例
gemini "分析当前任务清单"
gemini "执行任务 U-3 的 T5 分析阶段"
gemini "生成今天的开发日报"
```

### 使用提示词模板

1. **打开提示词模板库**
   ```bash
   cat .gemini-prompts.md
   ```

2. **复制对应的提示词**
   - 找到您需要执行的阶段
   - 复制完整的提示词
   - 替换 `{task_id}` 等占位符

3. **执行指令**
   ```bash
   gemini "[粘贴的提示词]"
   ```

### 常用指令速查

#### 📊 项目分析
```bash
# 分析当前进度
gemini "分析当前任务清单的执行情况"

# 查看特定任务
gemini "查看任务 U-3 的详细信息"

# 生成周计划
gemini "基于当前进度，生成本周开发计划"
```

#### 🔧 任务执行
```bash
# 初始化任务
gemini "初始化任务 U-3"

# 执行 T5 分析
gemini "执行任务 U-3 的 T5 分析阶段"

# 执行 T6 编码
gemini "执行任务 U-3 的 T6 编码阶段"

# 执行 T7 测试
gemini "执行任务 U-3 的 T7 测试阶段"

# 执行 T8 审计
gemini "执行任务 U-3 的 T8 审计阶段"

# 执行 T8.5 审查
gemini "执行任务 U-3 的 T8.5 代码审查阶段"

# 执行 T9 交付
gemini "执行任务 U-3 的 T9 交付阶段"
```

#### ⚡ 快捷指令
```bash
# 一键执行完整任务
gemini "一键执行任务 U-3 的完整开发流程"

# 快速完成 P2 任务
gemini "快速完成 P2 任务 P-10（简化流程）"

# 批量初始化任务
gemini "批量初始化任务 U-3, U-4, U-5"
```

#### 📈 进度管理
```bash
# 生成每日报告
gemini "生成今天的开发日报"

# 生成每周报告
gemini "生成本周的开发周报"

# 更新看板
gemini "更新任务 U-3 的看板状态，T5 阶段标记为已完成"
```

---

## 💡 实战示例

### 示例 1: 完整执行一个任务

```bash
# 步骤 1: 查看当前状态
gemini "分析当前任务清单，推荐下一个应该执行的任务"

# 假设推荐的是 U-3

# 步骤 2: 查看任务详情
gemini "查看任务 U-3 的详细信息"

# 步骤 3: 初始化任务
gemini "初始化任务 U-3"

# 步骤 4: 一键执行（推荐）
gemini "一键执行任务 U-3 的完整开发流程：

任务信息：
- 任务ID: U-3
- 任务名称: 构建登录页面 UI
- 优先级: P0

请按照任务清单 v4.0 的标准流程，依次执行：
1. T5 分析
2. T6 编码
3. T7 测试
4. T8 审计
5. T8.5 审查
6. T9 交付

每个阶段完成后，输出简要摘要。"

# 步骤 5: 查看结果
gemini "查看任务 U-3 的完成情况"
```

### 示例 2: 分阶段执行任务

```bash
# T5 分析
gemini "执行任务 U-3 的 T5 分析阶段：

任务信息：
- 任务ID: U-3
- 任务名称: 构建登录页面 UI
- 优先级: P0

执行步骤：
1. 读取 docs/pj_docs/02_需求原子化拆分.md
2. 读取 docs/pj_docs/04_接口与数据规约.md
3. 读取 docs/pj_docs/03_系统架构设计方案.md
4. 分析 html/login.html
5. 填写 T5_分析文档.md
6. 保存到 docs/pj_docs/tasks/U-3/T5_分析文档.md
7. 更新看板 T5 列为 ✅"

# T6 编码
gemini "执行任务 U-3 的 T6 编码阶段（前端）：

1. 读取 T5_分析文档.md
2. 读取编码规范
3. 从 html/login.html 迁移 UI 到 Vue
4. 实现交互逻辑
5. 生成 T6_变更清单.md
6. 更新看板 T6 列为 ✅"

# 依次执行 T7-T9...
```

### 示例 3: 并行执行多个任务

```bash
gemini "并行执行以下数据库设计任务：

任务列表：
- U-9: 设计 user 数据库表
- F-4: 设计 food 数据库表
- L-1: 设计 diet_log 数据库表
- A-1: 设计 daily_goal 数据库表

执行策略：
1. 确认这些任务之间无依赖关系
2. 为每个任务创建独立的工作目录
3. 按照标准流程并行执行 T5-T9
4. 分别更新看板
5. 输出所有任务的完成摘要"
```

### 示例 4: 处理测试失败

```bash
# 假设 U-3 的 T7 测试失败

gemini "任务 U-3 的 T7 测试失败，需要返工：

1. 在 T7_测试报告.md 中详细记录失败原因
2. 更新看板 T7 列为 🔴（阻塞）
3. 分析失败原因
4. 返回 T6 修复代码
5. 修复完成后，重新执行 T7-T9
6. 输出修复摘要"
```

---

## 📊 看板管理

### 看板状态说明

| 图标 | 状态 | 说明 |
|------|------|------|
| ✅ | 已完成 | 该阶段已完成 |
| 🏃 | 进行中 | 该阶段正在进行 |
| 📅 | 待开始 | 该阶段尚未开始 |
| ⚠️ | 有风险 | 存在技术债或临时方案 |
| ↩️ | 已驳回 | 审查不通过，需返回修改 |
| ⛔ | 已阻塞 | 因依赖或问题无法继续 |

### 查看看板

```bash
# 方式 1: 直接查看文件
cat docs/pj_docs/04.5_原子任务交付看板.md

# 方式 2: 使用 Gemini 分析
gemini "分析当前任务看板，告诉我：
1. 总体进度
2. 各优先级任务完成情况
3. 当前阻塞的任务
4. 下一步建议"
```

### 更新看板

```bash
# Gemini 会自动更新看板
# 每个阶段完成后，Gemini 会自动将对应列标记为 ✅

# 手动更新（如需要）
gemini "更新任务 U-3 的看板状态：
- 阶段: T5
- 状态: ✅"
```

---

## 📈 进度追踪

### 每日进度报告

```bash
gemini "生成今天（2026-01-27）的开发日报：

1. 读取任务看板
2. 统计今日完成情况
3. 工时统计
4. 问题记录
5. 明日计划
6. 保存到 docs/reports/daily_2026-01-27.md"
```

### 每周进度报告

```bash
gemini "生成本周的开发周报：

1. 统计本周完成任务
2. 工时统计和效率分析
3. 里程碑达成情况
4. 问题与风险
5. 技术债务
6. 下周计划
7. 趋势分析
8. 保存到 docs/reports/weekly_2026-W04.md"
```

---

## 💡 最佳实践

### 1. 任务选择策略

**优先级排序**:
1. P0 任务 > P1 任务 > P2 任务
2. 数据库设计任务优先（通常是其他任务的依赖）
3. 后端 API 优先于前端 UI
4. 无依赖任务优先于有依赖任务

**并行开发**:
- 数据库设计任务可以并行（U-9, F-4, L-1, A-1）
- 不同域的任务可以并行（用户域 + 食物域）
- 前后端可以并行（基于 API 契约）

### 2. 使用提示词模板

**推荐做法**:
```bash
# 1. 打开提示词模板库
cat .gemini-prompts.md

# 2. 找到对应阶段的提示词
# 3. 复制并替换占位符
# 4. 执行指令
```

**不推荐做法**:
```bash
# ❌ 过于简单的指令
gemini "做任务 U-3"

# ✅ 使用详细的提示词
gemini "执行任务 U-3 的 T5 分析阶段：[详细步骤]"
```

### 3. 时间管理

**单任务时间分配**（P0/P1）:
- T5 分析: 2-4h
- T6 编码: 2-8h
- T7 测试: 1-2h
- T8 审计: 30min
- T8.5 审查: 30min
- T9 交付: 30min
- **总计**: 6.5-15.5h

**每日目标**:
- 简单任务（低复杂度）: 1-2 个任务/天
- 中等任务（中复杂度）: 1 个任务/天
- 复杂任务（高复杂度）: 0.5 个任务/天

**每周目标**:
- Week 1: 完成 6-8 个 P0 任务
- Week 2: 完成 6-8 个 P0 任务
- Week 3: 完成剩余 P0 任务
- Week 4: 完成 P1 任务 + 测试优化

### 4. 质量保障

**必须执行**:
- ✅ T5 分析不能跳过
- ✅ T7 测试必须覆盖边界条件
- ✅ T8.5 审查必须检查逻辑正确性
- ✅ 技术债务必须明确标记

**可选优化**:
- P2 任务可以简化流程
- 轻微问题可以延后处理
- 优化建议可以分批实施

---

## 🔧 故障排除

### 问题1: T7 测试失败

**解决方案**:
```bash
gemini "任务 U-3 的 T7 测试失败，需要返工：
1. 记录失败原因
2. 标记看板为阻塞
3. 返回 T6 修复代码
4. 重新执行 T7-T9"
```

### 问题2: T8.5 审查不通过

**解决方案**:
```bash
gemini "任务 U-3 的 T8.5 审查不通过：
1. 查看审查意见
2. 标记看板为驳回
3. 根据意见修改代码
4. 重新执行 T7-T9"
```

### 问题3: 任务依赖阻塞

**解决方案**:
```bash
gemini "任务 U-3 依赖 U-2，但 U-2 未完成：
1. 标记看板阻塞源
2. 优先完成 U-2
3. 或使用 Mock 数据临时解除阻塞"
```

### 问题4: 技术债累积

**解决方案**:
```bash
gemini "为任务 U-3 标记技术债务：
1. 在 T8.5 文档中记录技术债
2. 更新看板状态为 ⚠️
3. 创建技术债清理任务
4. 定期清理技术债"
```

---

## 📚 参考资料

### 核心文档
- `任务清单_v4.1_防护增强版.md`: ⭐ 主任务清单（防护增强版）
- `任务清单_v4.0_优化版.md`: 基础版任务清单
- `防护增强版_T6编码提示词.md`: ⭐ 增强版编码提示词
- `AI开发问题解决方案.md`: 问题分析和解决方案
- `.gemini-prompts.md`: 完整提示词模板库
- `docs/pj_docs/02_需求原子化拆分.md`: 所有任务定义
- `docs/pj_docs/04.5_原子任务交付看板.md`: 进度追踪

### 规范文档
- `docs/init_docs/编码规范.md`: 编码规范
- `docs/init_docs/项目技术栈.md`: 技术栈说明
- `docs/pj_docs/03_系统架构设计方案.md`: 架构规范

### 模板文档
- `docs/templates/`: 所有文档模板

---

## 🎯 下一步

1. **立即开始**: 
   ```bash
   gemini "分析当前任务清单，推荐下一个任务"
   ```

2. **熟悉提示词模板**: 
   ```bash
   cat .gemini-prompts.md
   ```

3. **执行第一个任务**: 
   ```bash
   gemini "一键执行任务 U-3 的完整开发流程"
   ```

---

## 🆚 Gemini CLI vs 传统脚本

### 优势对比

| 特性 | 传统脚本 | Gemini CLI |
|------|----------|------------|
| **灵活性** | 固定逻辑 | 自然语言，灵活调整 |
| **学习成本** | 需要学习脚本语法 | 直接用中文描述需求 |
| **维护成本** | 需要修改脚本代码 | 只需调整提示词 |
| **智能化** | 无智能判断 | AI 自动判断和优化 |
| **错误处理** | 需要手动编写 | AI 自动处理异常 |
| **适应性** | 固定流程 | 根据实际情况调整 |

### 示例对比

**场景：初始化任务时发现目录已存在**

```bash
# ❌ 传统脚本
./scripts/init-task.sh U-3
# 输出：错误：目录已存在，是否覆盖？(y/N)
# 需要手动输入 y 或 N

# ✅ Gemini CLI
gemini "初始化任务 U-3，如果目录已存在，请备份后覆盖"
# AI 自动处理：备份 → 覆盖 → 完成
```

---

**祝开发顺利！** 🚀

如有问题，请参考 `.gemini-prompts.md` 提示词模板库或直接询问 Gemini。
