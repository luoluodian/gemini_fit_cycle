# U-1: 实现微信登录认证接口 - T7 测试报告

## 7.1 测试环境

- 后端版本: NestJS v11.1.9
- 数据库: MySQL (120.26.103.157)
- 测试时间: 2026-01-28 09:35

## 7.2 测试用例

| 用例ID | 测试场景 | 预期结果 | 实际结果 | 状态  |
| ------ | -------- | -------- | -------- | ----- |
| TC-01  | 微信登录成功 (首次授权) | 返回 accessToken, refreshToken, 用户信息 | 返回预期数据，DB 创建记录 | ✅ |
| TC-02  | 微信登录成功 (老用户登录) | 返回 accessToken, 现有用户信息 | 返回预期数据 | ✅ |
| TC-03  | 缺少 code 参数 | 返回 400 错误 (Bad Request) | 返回 400, 提示 code must be string | ✅ |
| TC-04  | 微信 API 返回错误 (无效 code) | 返回 401 错误 (Unauthorized) | 返回 401, 提示 invalid code | ✅ |

## 7.3 发现的问题

- [已修复] 数据库列名 `openid` 与实体 `openId` 不匹配 -> 已修正为 `open_id`。
- [已修复] `User` 实体中缺失 `target_calories` 等字段映射 -> 已补齐映射。

## 7.4 性能数据

- 响应时间: ~120ms (包含 DB 操作)
- 内存占用: 稳定
