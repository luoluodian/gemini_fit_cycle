# U-2: 前端认证服务 - T6 变更清单

## 6.1 修改文件

- `fit_cycle_web/src/constants/api-config.ts`:
    - 更新 `AUTH_ROUTES`：包含 `/user/`, `/diet-logs/`, `/diet-plans/`, `/auth/refreshToken`。
    - 更新 `PUBLIC_ROUTES`：包含 `/auth/wechatAuth`。
    - 更新 `SILENT_ROUTES`：包含 `/auth/refreshToken`。
- `fit_cycle_web/src/services/modules/user.ts`:
    - 重构 `refreshToken`：适配后端接口路径 `/auth/refreshToken` 及其响应结构。
    - 更新 `UserInfo` 和 `AuthResponse` 类型定义以匹配项目规范。
    - 清理过时的登录和配置相关函数，保持职责单一。
- `fit_cycle_web/src/services/http/interceptors.ts`:
    - 引入并使用 `src/constants/storage.ts` 中的常量键名。
    - 修复 `AuthInterceptor` 中的 `refreshToken` 逻辑，确保处理正确的字段名（`accessToken`, `refreshToken`, `user`）。
    - 统一 Token 刷新失败后的重定向逻辑。
- `fit_cycle_web/src/services/index.ts`:
    - 导出 `auth` 和 `plan` 模块，修复页面导入报错。

## 6.2 完整性检查结果

### 【导入语句检查】
- [x] 所有导入的模块都已安装？
- [x] 所有导入的文件路径都正确？ (已修复 `services/index.ts` 导出问题)
- [x] 所有导入的类/函数都存在？

### 【类型定义检查】
- [x] 所有使用的类型都已定义？ (`AuthResponse`, `UserInfo` 已更新)
- [x] 类型一致性检查？ (Interceptor 与 Service 响应结构一致)

### 【模块注册检查】
- [x] 新的 Service 是否已导出？ (已在 `services/index.ts` 导出)

### 【配置文件检查】
- [x] 路由鉴权规则是否更新？ (已在 `api-config.ts` 配置)
- [x] 存储键名是否统一？ (已使用 `storage.ts` 常量)

### 【构建验证】
- [x] `npm run build:weapp` 通过。