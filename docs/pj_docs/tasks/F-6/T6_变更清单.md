# F-6: 新增食物接口 - T6 变更清单

## 6.1 修改文件

- `fit_cycle_app/src/dtos/food.dto.ts`:
    - 重构了 `CreateFoodDto` 和 `UpdateFoodDto`。
    - 将字段名对齐至 `Food` 实体标准：`caloriesPer100g`, `proteinPer100g`, `fatPer100g`, `carbsPer100g`, `defaultUnit`。
    - 补充了 `gi`, `image_url`, `description` 的验证逻辑。
    - 添加了 `@Transform` 装饰器确保数值类型转换。
- `fit_cycle_app/src/modules/food/food.service.ts`:
    - 重构 `findFood`：修正了过滤条件和排序字段名，确保其引用正确的数据库列。
    - 重构 `addFood`：使用 `repo.create()` 和 `repo.save()` 确保实体生命周期完整，修复了保存逻辑。
    - 重构 `updateFood`：对齐字段名并返回更新后的对象。
- `fit_cycle_app/src/modules/food/food.controller.ts`:
    - 修正了 `update` 方法的 DTO 类型引用。

## 6.2 完整性检查结果

### 【字段对齐检查】
- [x] DTO 字段与 Entity 属性名完全匹配。
- [x] Service 中的 SQL 查询条件与数据库列名匹配（`calories_per_100g` 等）。

### 【验证逻辑检查】
- [x] `caloriesPer100g` 等必填字段已添加 `@IsNumber` 和 `@IsNotEmpty`。
- [x] `gi`, `image_url` 等可选字段已添加 `@IsOptional`。

### 【构建验证】
- [x] `npm run build` 成功。
