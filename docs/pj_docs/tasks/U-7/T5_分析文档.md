# U-7: 个人档案 UI - T5 分析文档

## 5.1 模块关联性审计

- **涉及公共 Store**: `useUserStore` (Pinia) - 核心数据来源（昵称、头像、打卡天数等）。
- **涉及组件**:
  - `ProfileHeader.vue`: 头部用户信息展示。
  - `WeeklyProgressChart.vue`: 摄入趋势图（需修正为跨端兼容方案）。
  - `BaseButton.vue`: 全局通用按钮（U-4 交付）。
- **涉及路由**: `navigateTo` 跳转至计划页、设置页等。

## 5.2 影响评估

- **修改点**:
  - `src/pages/profile/index.vue`: 从 Store 读取真实数据，替换 Mock 数据。
  - `src/components/profile/ProfileHeader.vue`: 支持展示 Store 中的头像和昵称。
  - `src/components/profile/WeeklyProgressChart.vue`: 彻底重构，移除 `window` 和 `document` 依赖，改用 CSS 实现高保真进度柱状图。
- **对现有功能的影响**: 
  - 增强了个人中心的真实交互感。
  - 解决了在小程序真机上图表无法渲染的隐患。

## 5.3 技术落地计划

### 1. 数据对齐
- `userData`: 绑定 `userStore.userInfo`。
- `isLoggedIn`: 守卫校验（U-5 已完成），确保进入此页面时必有数据。

### 2. 跨端图表方案
- **放弃 ECharts JS 模式**: 避免 `NodeList`, `Canvas` 适配问题。
- **采用 CSS Flex 方案**: 
  - 使用 `view` 模拟柱状图。
  - 通过 `height` 百比分实现趋势展示。
  - 确保在 H5 和小程序中表现完全一致。

### 3. 组件重构
- 统一使用 `BaseButton` 处理“查看计划”、“编辑”等按钮。
- 确保毛玻璃效果在 `index.scss` 中全局复用。

## 5.4 验收标准 (T7 预案)
- [ ] 页面能正确显示当前登录用户的微信昵称和头像。
- [ ] 本周趋势图在小程序开发工具中正常显示，无 `ReferenceError`。
- [ ] 点击“帮助”、“关于”等按钮有正确的交互反馈。
- [ ] `ProfileHeader` 渐变色与原型一致。
