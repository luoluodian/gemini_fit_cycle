# T5 分析文档: R-7 数量键盘组件 (Quantity Keyboard)

## 1. 任务背景 (Task Background)
任务 **R-7** 旨在为饮食记录提供一个极速录入方案。现有的 `QuantityStepper` 无法满足快速输入大额数字的需求。本组件需要整合数字输入与单位切换，提升打卡体验。

## 2. 现状与资产复用 (Current Assets)
- **底层支持**: 复用 `nut-number-keyboard` 的基础样式与数字冒泡逻辑。
- **业务叠加**: 在数字键盘上方增加“单位选择条” (Unit Selector)。

## 3. 功能设计 (Functional Design)

### 3.1 界面线框图 (ASCII Wireframe)
```text
+---------------------------------------+
|  [ [1] 100 ] [ [2] g / ml / 个 ]      | <-- 输入预览区
+---------------------------------------+
|  [3] 单位切换: [ 克 ] [ 毫升 ] [ 份 ] | <-- 业务单位条
+---------------------------------------+
|   1   2   3   [ Backspace ]           |
|   4   5   6   [ Clear ]               | <-- 数字键盘区 (NutUI)
|   7   8   9   [ Done ]                |
|   .   0       [ Hide ]                |
+---------------------------------------+
```

### 3.2 核心交互
1.  **动态单位**: 传入 `baseUnit` (如 g)。根据食材类型自动配置备选单位（如液态食物显示 g/ml）。
2.  **即时反馈**: 键盘输入时，数值实时同步至预览区。
3.  **智能小数点**: 防御重复输入小数点逻辑。

## 4. 技术实现要点 (Implementation)

### 4.1 Props 定义
- `modelValue`: 数量 (number)。
- `unit`: 当前单位 (string)。
- `unitOptions`: 备选单位列表 (Array<string>)。

### 4.2 事件
- `update:modelValue`: 数值更新。
- `update:unit`: 单位更新。
- `confirm`: 点击“完成”。

## 5. 潜在风险与过度优化审计 (Risks & Audit)
- **过度优化风险**: 
    - *风险*: 将键盘做成“可拖拽”、“可换肤”等功能。
    - *对策*: **禁止**。保持纯净的业务逻辑，仅关注输入效率。
- **重复造轮子**:
    - *风险*: 手写数字按键的 CSS。
    - *对策*: **禁止**。必须基于 NutUI 封装，以保证多端适配（微信小程序/H5）的稳定性。

## 6. 结论 (Conclusion)
R-7 不应是一个独立的 UI 项目，而是一个**“业务逻辑适配器”**。通过将 NutUI 键盘与饮食单位逻辑缝合，实现高性能的录入工具。
