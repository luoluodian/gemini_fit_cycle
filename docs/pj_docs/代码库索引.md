# 项目代码库索引

> **版本**: 1.0
> **日期**: 2026-01-27
> **生成**: Gemini AI Assistant

本文档提供了 `fit_cycle` 项目核心代码库的索引，帮助开发者快速定位关键文件和模块。

## 1. 后端 (fit_cycle_app)

基于 NestJS 的后端服务。

### 1.1 核心模块 (Modules)
位于 `src/modules/`

- **Auth (`auth/`)**: 用户认证与授权模块。
  - `auth.controller.ts`: 处理登录 (`/auth/wechatAuth`) 和 Token 刷新接口。
  - `auth.service.ts`: 核心认证逻辑，微信 API 调用 mock，JWT 生成。
  - `jwt.strategy.ts`: JWT 验证策略。
- **User (`user/`)**: 用户管理模块。
  - `user.entity.ts`: 用户数据库实体定义。
  - `user.service.ts`: 用户数据的增删改查。
- **Food (`food/`)**: 食物库管理模块。
- **DietLogs (`diet-logs/`)**: 饮食记录模块。
- **DietPlans (`diet-plans/`)**: 饮食计划模块。
- **FoodItems (`food-items/`)**: (可能用于更细粒度的食物项管理)。
- **Dict (`dict/`)**: 数据字典模块。
- **Share (`share/`)**: 分享功能模块。

### 1.2 数据库实体 (Entities)
位于 `src/database/entity/`

- `user.entity.ts`: 用户表定义。
- `food.entity.ts`: 食物表定义。
- `diet-log.entity.ts`: 饮食记录表定义。
- `daily-goal.entity.ts`: 每日营养目标表定义。
- `diet-plan.entity.ts`: 饮食计划表定义。
- `plan-day.entity.ts`: 计划日模板。
- `plan-meal.entity.ts`: 计划餐次模板。
- `data-dictionary.entity.ts`: 数据字典表。

### 1.3 数据传输对象 (DTOs)
位于 `src/dtos/`

- **Auth**: `auth-login.dto.ts` (登录请求), `auth-response.dto.ts` (登录响应)。
- **User**: `user.dto.ts` (用户信息/更新)。
- **Food**: `food.dto.ts`, `create-food-item.dto.ts`。
- **Log**: `create-diet-log.dto.ts`, `update-diet-log.dto.ts`。
- **Plan**: `create-diet-plan.dto.ts`, `update-diet-plan.dto.ts`, `import-plan.dto.ts`。

### 1.4 通用 (Common)
位于 `src/common/`

- **Filters (`filters/`)**:
  - `http-exception.filter.ts`: 全局异常过滤器，统一错误响应格式。
- **Interceptors (`interceptors/`)**:
  - `transform.interceptor.ts`: 全局响应拦截器，统一成功响应格式 `{ code: 200, data: ... }`。
- **Logger (`logger/`)**:
  - `winston.config.ts`: Winston 日志配置。
- **Transformers (`transformers/`)**:
  - `user.transformer.ts`: 用户对象数据转换/脱敏。

---

## 2. 前端 (fit_cycle_web)

基于 Taro + Vue 3 的多端应用。

### 2.1 页面 (Pages)
位于 `src/pages/`

- **Login (`login/`)**: 登录页。
- **Index (`index/`)**: 首页/今日饮食记录页。
- **Food (`food/`)**: 食物列表/搜索页。
- **Plan (`plan/`)**: 计划列表管理页。
- **DailyPlan (`daily-plan/`)**: 每日计划详情页。
- **Profile (`profile/`)**: 个人中心页。
- **PlanCreator (`plan-creator/`)**: 创建新计划流程页。

### 2.2 组件 (Components)
位于 `src/components/`

- **Common (`common/`)**: 通用组件。
  - `MealCard.vue`: 餐次卡片。
  - `FoodItem.vue`: 食物列表项。
  - `BaseModal.vue`, `ErrorMessage.vue`.
- **Home (`home/`)**: 首页特定组件。
  - `DateNavigation.vue`: 日期切换。
  - `DailyGoalsOverview.vue`: 营养目标概览。
- **Login (`login/`)**: 登录页组件。
  - `LoginButton.vue`, `PrivacyModal.vue`.
- **Plan (`plan/`)**: 计划页组件。
  - `PlanCard.vue`, `PlanTabs.vue`.
- **DailyPlan (`daily-plan/`)**: 每日计划页组件。
  - `FoodModal.vue`: 食物选择弹窗。

### 2.3 服务 (Services)
位于 `src/services/`

- **HTTP (`http/`)**: 网络请求核心封装。
  - `index.ts`: 导出 `httpRequest` 实例。
  - `request.ts`: `RequestManager` 类，封装 `Taro.request`。
  - `interceptors.ts`: 包含 `AuthInterceptor` (Token注入/刷新) 和 `ErrorInterceptor`。
- **Modules (`modules/`)**: 业务 API 封装。
  - `auth.ts`: 登录 API (`login`).
  - `user.ts`: 用户信息 API.
  - `plan.ts`, `record.ts`.

### 2.4 状态管理 (Stores)
位于 `src/stores/`

- `user.ts`: 用户状态 (Token, UserInfo)，包含登录/登出 Action。
- `counter.ts`: (示例/计数器).

### 2.5 工具 (Utils)
位于 `src/utils/`

- `env.ts`: 环境判断 (`isDevelopment`, `getApiBaseUrl`)。
- `storage.ts`: 本地存储封装 (`setStorage`, `getStorage`)。
- `error-handler.ts`: 统一错误处理逻辑。

### 2.6 常量 (Constants)
位于 `src/constants/`

- `api-config.ts`: API 基础配置和路由白名单。
- `storage.ts`: 存储 Key 定义 (`ACCESS_TOKEN_KEY`).
- `routes.ts`: 路由路径常量。