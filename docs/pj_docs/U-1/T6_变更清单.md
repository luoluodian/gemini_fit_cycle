# U-1: 微信登录接口 - T6 变更清单

> **变更日期**: 2026-01-31 (补录)  
> **执行人**: AI Assistant

---

## 1. 变更摘要

本次任务实现了基于微信小程序的登录认证接口。通过接收前端传来的 `code`，后端调用微信 `jscode2session` 接口获取 `openid`，并自动完成用户的注册或登录，最终颁发 JWT Token。

## 2. 文件变更列表

### 新增/修改文件

| 文件路径 | 变更类型 | 简要说明 |
|:---|:---|:---|
| `fit_cycle_app/src/modules/auth/auth.controller.ts` | 新增 | `wechatLogin` 接口入口 |
| `fit_cycle_app/src/modules/auth/auth.service.ts` | 新增 | `wechatAuth` 核心业务逻辑 |
| `fit_cycle_app/src/dtos/user.dto.ts` | 修改 | 新增 `WechatAuthDto` |

## 3. 详细变更内容

### 3.1 `AuthController`
- [x] 定义 `POST /auth/wechatAuth` 接口。
- [x] 使用 `WechatAuthDto` 进行参数校验。

### 3.2 `AuthService`
- [x] 集成 `HttpService` 调用微信 API。
- [x] 实现 `findOrCreateByOpenid` 逻辑。
- [x] 生成并返回 `accessToken` 和 `refreshToken`。

## 4. 验证计划

1.  **单元测试**: 验证 Service 的登录逻辑分支。
2.  **接口测试**: 使用 Postman 模拟调用（需 Mock 微信 API 响应）。
