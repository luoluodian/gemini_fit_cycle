# F-2: 食材搜索接口 - T6 变更清单

> **变更日期**: 2026-01-31  
> **执行人**: AI Assistant

---

## 1. 变更摘要

本次任务完成了食材搜索接口的功能增强，通过升级 DTO 和 Service 逻辑，支持了分类筛选功能，并统一了查询参数的接收方式。

## 2. 文件变更列表

### 修改文件

| 文件路径 | 变更类型 | 说明 |
|:---|:---|:---|
| `fit_cycle_app/src/dtos/food-item.dto.ts` | 修改 | `QueryFoodItemDto` 新增 `category` 字段，并添加 `@Type(() => Number)` 保证分页参数类型正确。 |
| `fit_cycle_app/src/modules/food-items/food-items.service.ts` | 修改 | `list` 方法改用 `QueryBuilder` 实现，支持多维度组合筛选（关键词 + 分类）。 |
| `fit_cycle_app/src/modules/food-items/food-items.controller.ts` | 修改 | `list` 接口改用 `@Query()` 装饰器直接绑定 DTO，简化参数传递。 |

## 3. 详细确认内容

- [x] **多条件组合**: 实现了 `q` 和 `category` 的逻辑与 (`AND`) 筛选。
- [x] **类型安全**: 分页参数 `page` 和 `pageSize` 现在能正确转换并验证为数字。
- [x] **分类过滤**: 严格校验 `category` 必须属于 `FoodCategory` 枚举。

## 4. 验证计划

1.  **功能验证**:
    - `GET /food-items?q=鸡`: 应返回包含“鸡”的食材。
    - `GET /food-items?category=protein`: 应返回所有蛋白质类食材。
    - `GET /food-items?q=鸡&category=protein`: 应返回分类为蛋白质且名称含“鸡”的食材。
2.  **构建验证**: 运行 `npm run build` 确保无编译错误。
