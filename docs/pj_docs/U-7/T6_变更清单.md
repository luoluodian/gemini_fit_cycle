# U-7: 健康档案接口 - T6 变更清单

> **变更日期**: 2026-01-31  
> **执行人**: AI Assistant

---

## 1. 变更摘要

本次任务通过验证 `UserController` 和 `UserTransformer` 的逻辑，正式确立 `PUT /user/info` 为健康档案更新的正式接口，并确保其响应体中正确包含了自动重算的 `bmr` 和 `tdee` 字段。

## 2. 文件变更列表

### 确认/校验文件

| 文件路径 | 状态 | 简要说明 |
|:---|:---|:---|
| `fit_cycle_app/src/modules/user/user.controller.ts` | 确认 | 验证 `updateMe` 方法正确调用 Transformer 并返回聚合后的用户档案。 |
| `fit_cycle_app/src/common/transformers/user.transformer.ts` | 确认 | 验证已正确从 `HealthProfile` 实体提取并映射 `bmr` 与 `tdee`。 |

## 3. 详细确认内容

### 3.1 `UserController` 逻辑确认
- [x] 接口路径 `PUT /user/info` 已绑定并受 `JwtAuthGuard` 保护。
- [x] 成功调用 `userService.updateMe` 触发 BMR 重算逻辑。
- [x] 返回值通过 `UserTransformer.toResponse` 封装，确保前端获得一致的数据结构。

### 3.2 `UserTransformer` 映射确认
- [x] 映射 `bmr`: 映射自 `profile?.bmr`。
- [x] 映射 `tdee`: 映射自 `profile?.tdee`。
- [x] 映射 `isCompleted`: 增加对健康档案完整性的布尔判断。

## 4. 验证计划

1.  **静态类型验证**: 确认 `UserResponseDto` 定义中已包含 `bmr` 和 `tdee` 字段。
2.  **端到端测试**: (将在 T7 阶段执行) 模拟发送身体数据更新请求，验证响应 JSON 中包含预期的计算结果。
