# P-6 创建向导 Step 1 - 基础设置 分析报告

## 1. 业务目标 (Business Goal)
实现饮食计划创建流程的第一步，收集计划的核心元数据，包括名称、类型（常规/碳循环）、周期天数、周期数以及激活状态。此步骤为后续的碳循环配置（Step 1.5）或周期列表生成（Step 2）提供基础参数。

## 2. 原型分析 (Prototype Analysis) - 参考 `html/new-plan.html`
- **标题**: "新建饮食计划"
- **表单项**:
  - **计划名称**: 必填文本输入。
  - **计划类型**: 
    - "常规" (custom): 基础类型。
    - "碳循环" (carb-cycle): 进阶类型，选中后下一步将跳转至 `carb-cycle-setup.html`。
  - **周期设置**:
    - **每周期天数**: 数字输入，建议 3~7 天，范围 1~14。
    - **周期数量**: 数字输入，范围 1~10。
    - **总天数展示**: 自动计算 `每周期天数 * 周期数量` 并展示。
- **状态设置**: "保存后设为当前激活计划" (checkbox)。
- **交互流**:
  - 点击"下一步"：
    - 若类型为 `carb-cycle` -> 进入 Step 1.5 (碳循环配置)。
    - 若类型为 `custom` -> 进入 Step 2 (周期列表管理)。

## 3. 技术方案 (Technical Solution)

### 3.1 状态管理 (Pinia)
使用 `planStore.draft` 存储草稿数据。
```typescript
interface PlanDraft {
  name: string;
  type: 'custom' | 'carb-cycle';
  cycleDays: number;
  cycleCount: number;
  setActive: boolean;
  // ... 其他后续步骤数据
}
```

### 3.2 组件拆分
- `pages/plan-creator/index.vue`: 主页面容器，处理步骤逻辑和底部操作栏。
- `components/plan-creator/BasicInfoStep.vue`: 渲染计划名称、类型选择和激活开关。
- `components/plan-creator/CycleSettingsStep.vue`: 渲染天数设置、周期数及总天数计算。

### 3.3 路由逻辑
```typescript
const handleNext = () => {
  if (!planStore.draft.name.trim()) {
    showError("请输入计划名称");
    return;
  }
  if (planStore.draft.type === 'carb-cycle') {
    Taro.navigateTo({ url: "/pages/carb-cycle-setup/index" });
  } else {
    planStore.initTemplates(); // 根据周期天数初始化空模板
    Taro.navigateTo({ url: "/pages/plan-templates/index" });
  }
};
```

## 4. 接口规约 (API Requirement)
本步骤仅在前端收集数据，暂不调用后端接口。数据将持久化在 Store 中，直到 Step 3 (P-9) 完成后统一提交。

## 5. 验收标准 (Acceptance Criteria)
- [ ] 页面布局与 `new-plan.html` 保持高度一致。
- [ ] 计划名称不能为空。
- [ ] 周期天数和周期数量改变时，总天数实时更新。
- [ ] 选择不同类型，点击“下一步”跳转至对应的页面。
- [ ] 默认值：周期天数 7，周期数量 3，类型“常规”，激活状态开启。
