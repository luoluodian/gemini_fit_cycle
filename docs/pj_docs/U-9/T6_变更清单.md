# U-9: User 实体定义 - T6 变更清单

> **变更日期**: 2026-01-31  
> **执行人**: AI Assistant

---

## 1. 变更摘要

本次任务通过对现有实体代码进行合规性审计，正式确立 `User` 与 `HealthProfile` 实体作为项目的交付基准。经检查，现有定义完全对齐 `04_接口与数据规约.md`。

## 2. 文件变更列表

### 确认/校验文件

| 文件路径 | 状态 | 简要说明 |
|:---|:---|:---|
| `fit_cycle_app/src/database/entity/user.entity.ts` | 确认 | 字段定义、唯一性索引及 OneToOne 关联配置正确。 |
| `fit_cycle_app/src/database/entity/health-profile.entity.ts` | 确认 | 字段精度 (`decimal`)、一对一反向关联及级联删除配置正确。 |

## 3. 详细校验内容

### 3.1 `User` 实体 (`users` 表)
-   [x] 表名使用 `snake_case` (`users`)。
-   [x] `openId` 设置为 `unique: true`。
-   [x] 关联关系 `healthProfile` 配置了 `cascade: true`。

### 3.2 `HealthProfile` 实体 (`health_profiles` 表)
-   [x] 表名使用 `snake_case` (`health_profiles`)。
-   [x] `height`, `weight` 使用 `decimal(5, 2)`，确保身高/体重精度。
-   [x] `activityLevel` 使用 `decimal(3, 2)`。
-   [x] `bmr`, `tdee` 使用 `int` 类型。
-   [x] 配置了 `onDelete: 'CASCADE'`，确保用户注销时健康档案同步清理。

## 4. 验证计划

1.  **编译验证**: 运行 `npm run build` 确保实体类无语法错误且 TypeORM 元数据加载正常。
2.  **Schema 同步**: (可选，需连接 DB) 通过 `typeorm schema:log` 确认生成的 SQL 符合预期。
