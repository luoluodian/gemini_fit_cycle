# P-5: 计划列表 UI - 分析文档

> **任务 ID**: P-5
> **优先级**: P0
> **当前状态**: T5 分析完成 (已覆盖逻辑补全)

## 1. 业务需求概述
展示用户当前正在执行的计划、历史计划以及系统推荐的计划模板。提供从零创建计划和通过分享码导入计划的入口。

### 1.1 核心功能点 (基于原型 html/plan.html)
- **多状态列表**: 支持“进行中”和“已完成”计划的 Tab 切换展示。
- **进度可视化**: 使用线性进度条展示计划完成百分比。
- **推荐系统**: 展示官方推荐的减脂、增肌、均衡计划。
- **交互入口**: 
  - “新建”按钮触发选项弹窗。
  - 选项弹窗包含“创建新计划”和“导入计划”两个功能。

## 2. 技术设计方案

### 2.1 组件结构
- `Plan/index.vue`: 页面主容器，负责数据加载和状态管理。
- `PlanHeader.vue`: 统一导航头，包含“新建”入口。
- `PlanTabs.vue`: 封装 Tab 切换逻辑。
- `PlanCard.vue`: 计划项卡片，处理线性进度条和状态标签。
- `RecommendedPlans.vue`: 推荐计划列表。
- `CreateOptionsModal.vue`: (新增) 实现原型中的多选项入口。
- `NewPlanModal.vue`: 创建表单。
- `ImportPlanModal.vue`: 导入表单。

### 2.2 数据模型与接口
- **获取列表**: `GET /diet-plans` -> 映射至本地 `Plan` 接口。
- **状态转换**: 
  - 激活: `POST /diet-plans/:id/activate`
  - 暂停: `POST /diet-plans/:id/pause`
- **导入**: `POST /diet-plans/import` (配合 P-14 实现)。

### 2.3 关键逻辑实现
- **路由兼容性**: 在 H5 模式下通过 `custom-tab-bar/index.vue` 确保图标和路由切换正常。
- **互斥激活**: UI 层监听激活成功后，自动刷新列表以反映全局唯一的 `active` 状态。

## 3. 验收标准 (Definition of Done)
- [x] UI 样式与 `html/plan.html` 还原度 > 95% (含线性进度条)。
- [x] Tab 切换逻辑正常，无数据混淆。
- [x] 点击“新建”能够弹出“创建/导入”选项弹窗。
- [x] 成功对接后端 API，能够真实加载并展示计划。
- [x] 修复 `activeTab` undefined 导致的 Vue 渲染警告。